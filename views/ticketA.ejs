<!DOCTYPE html>
<html lang="en">
<% include partials/head.ejs %>

    <body style="font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif">
        <div id="ticketmain">
            <div class="ticketsub">
                <% if (details !== ""){ %>
                <div class="ticketpage">
                    <div class="container-fluid">
                        <div class="row text-center" style="box-shadow: 0px 0px 7px #D3D3D3;border-radius: 15px;border-bottom: 3px solid;">

                            <h3>
                                <span class="bus"></span>
                            </h3>
                            <div class="col-xs-4">
                                <h4>From</h4>
                                <p>
                                    <span class="initial"><%=details.d_from %></span>
                                </p>
                            </div>
                            <div class="col-xs-4">
                                <h4 class="price">GHâ‚µ <%=chosendata.amount %></h4>
                                <h4 class="glyphicon glyphicon-arrow-right"></h4>
                                <h4 class="duration"><%=details.journeyhrs %></h4>
                            </div>
                            <div class="col-xs-4">
                                <h4>To</h4>
                                <p>
                                    <span class="final"><%=details.d_to %></span>
                                </p>
                            </div>
                        </div>
                        <div class="row text-center" style="box-shadow: 0px 0px 7px #D3D3D3;border-radius: 15px;border-bottom: 3px solid;">
                            <div class="col-xs-4">
                                <h4>Departure</h4>
                                <p>
                                    <span class="departure"><%=chosendata.departdate %></span>
                                </p>
                            </div>
                            <div class="col-xs-4">
                                <h3 class="glyphicon glyphicon-calendar"></h3>
                            </div>
                            <div class="col-xs-4">
                                <h4>Time</h4>
                                <p>
                                    <span class="time"><%=chosendata.departtime %></span>
                                </p>
                            </div>
                        </div>
                        <div class="row text-center" style="box-shadow: 0px 0px 7px #D3D3D3;border-radius: 15px;">
                            <h3>Details</h3>
                            <div class="col-xs-6">
                                <h4 class="busnumber">Bus No.</h4>
                                <h4 class="location">Location</h4>
                                <h4 class="seatnumber">Seat</h4>
                            </div>
                            <div class="col-xs-6">
                                <h4>GT 4545 18</h4>
                                <h4>Neoplan station</h4>
                                <h4>30</h4>
                            </div>
                        </div>
                        <div class="row text-center" style="width: 50%; margin: auto;box-shadow: 0px 0px 7px #D3D3D3;border-radius: 15px;">
                            <div class="col-xs-6 text-center" style="width: 100%;">
                                <img class="img-responsive" src="<%=qrurl %>" alt="">
                                <!--QrCode goes here-->
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg text-center">
                                <a class="btn btn-primary btn-block" href="/pay">Proceed</a>
                            </div>
                        </div>
                    </div>  
                </div>
                <% }else { %>
                    <h2 style="color: red;">Ticket not available</h2>
                <% }%>            
            </div>        
        </div>
    </body>
    <script>
    //     //Rave Pay
    // var API_publicKey = "FLWPUBK_TEST-abdf93acc2ba3a7b94fa44ad0d8ec0cf-X";
    
    // function payWithRave() {
    //     var x = getpaidSetup({
    //         PBFPubKey: API_publicKey,
    //         customer_email: "user@example.com",
    //         amount: 2000,
    //         customer_phone: "234099940409",
    //         currency: "GHS",
    //         txref: "rave-123456",
    //         meta: [{
    //             metaname: "flightID",
    //             metavalue: "AP1234"
    //         }],
    //         onclose: function() {},
    //         callback: function(response) {
    //             var txref = response.tx.txRef; // collect txRef returned and pass to a server page to complete status check.
    //             console.log("This is the response returned after a charge", response);
    //             if (response.tx.chargeResponseCode == "00" ||response.tx.chargeResponseCode == "0") {
    //                 var fullname = "";
    //                 var phone = "";
    //                 var company_id = "";
    //                 var bus_no = "";
    //                 var seat = "";
    //                 var location = "";
    //                 var t_from = "";
    //                 var t_to = "";
    //                 var the_date = "";
    //                 var the_time = "";
    //                 var amount = "";
    //                 var payment_mehtod = "";
    //                 transaction_id = ""
    //                 var status = ""
    //                 axios.post("http://achatcryptostg.com/stcapp/public/savebookdetails",{
    //                     fullname = fullname,
    //                     phone = phone,
    //                     company_id = company_id,
    //                     bus_no = bus_no,
    //                     seat = seat,
    //                     location = location,
    //                     t_from = t_from,
    //                     t_to = t_to,
    //                     the_date = the_date,
    //                     the_time = the_time,
    //                     amount = amount,
    //                     payment_mehtod = payment_mehtod,
    //                     transaction_id = transaction_id,
    //                     status = status
    //                 })
    //                 .then(function(response){
    //                     console.log(response)
    //                 })
    //                 .catch(function(error){
    //                     console.log(error);
    //                 })
    //                 // redirect to a success page
    //                 // window.location.href = "views\ticket-success.ejs"
    //             } else {
    //                 // redirect to a failure page.
    //             }
    
    //             x.close(); // use this to close the modal immediately after payment.
    //         }
    //     });
    // }
    // //Rave Pay
    </script>
</html>