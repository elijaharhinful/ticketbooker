<!DOCTYPE html>
<html lang="en">
<% include partials/dashboard-head.ejs %>
<% include partials/ticketmain.ejs %>

<body>
    <div id="historypage">
        <div id="main">
            
            <div class="container-fluid">
                <div class="row">
                        <div class="col-sm-3" style="padding-left:0px">
                                <div id="mySidenav">
                                    <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
                                    <div class="header">
                                        <img src="\public\img\avatar.png" class="img-circle" alt="User image" width="150" height="150">
                                        <h3>Welcome</h3>
                                        <h4><%=user.firstname %></h4>
                                        <a style="width:50%;margin:auto;margin-bottom:10px;" class="btn btn-default btn-success btn-block btn-sm" href="/booking">Book ticket</a>
                                    </div>
                                    
                                    <ul class="nav">
                                        <li>
                                            <a href="/dashboard">
                                                    <i class="glyphicon glyphicon-home"></i>
                                                    Dashboard
                                            </a>
                                        </li>
                                        <li class="active1">
                                            <a href="/history">
                                                    <i class="glyphicon glyphicon-shopping-cart"></i>
                                                Tickets
                                            </a>
        
                                        </li>
                                        <li>
                                            <a href="/profile"> 
                                                    <i class="glyphicon glyphicon-user"></i>
                                                    Profile
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#">
                                                    <i class="glyphicon glyphicon-comment"></i>
                                                    Help
                                            </a>
                                        </li>
                                        <li>
                                            <a href="/contact" target="_blank"> 
                                                    <i class="glyphicon glyphicon-phone-alt"></i>
                                                    Contact us
                                            </a>
                                        </li>
                                        <li>
                                            <a href="/index">
                                                    <i class="glyphicon glyphicon-log-out"></i>
                                                    Logout
                                            </a>
                                        </li>
                                    </ul>
                                </div>

                            </div>
                    <div class="col-sm-9 table-responsive">
                            <% include layouts/dashboard-header.ejs %>
                            <div class="conatainer-fluid" style="color: white">
                                <h1 class="text-center">TICKET HISTORY</h1>
                                <h3 class="text-center">Click on table to view ticket details</h3>
                            </div>   
                            <%- success %>
                            <table id="ticketHistory" class="table table-bordered table-sm" style="width:100%;overflow-x: scroll;">
                                <thead>
                                    <tr>
                                        <th>Ticket ID</th>
                                        <th>Date</th>
                                        <th>From</th>
                                        <th>To</th>
                                        <th>Price(GHâ‚µ)</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <% for (var i=0; i < t_history.length;i++){ %>
                                        <tr>
                                            <td class="historyid"><%=t_history[i].id %></td>
                                            <td class="historydate"><%=t_history[i].the_date %></td>
                                            <td class="historyfrom"><%=t_history[i].t_from %></td>
                                            <td class="historyto"><%=t_history[i].t_to %></td>
                                            <td class="historyamount"><%=t_history[i].amount %></td>
                                            <% if (t_history[i].status == 0){ %>
                                                <td class="historystatus"><a class="btn btn-sm btn-danger">Cancelled</a></td>   
                                            <%}else{%>
                                                <td class="historystatus"><a class="btn btn-sm btn-primary" data-toggle="modal" data-target="#ticketmain">Processed </a></td>
                                            <%}%>
                                            
                                            <td class="historyqr" style="display: none;"><img src="<%=t_history[i].qrcode %>"></td>
                                            <td class="historytransactionid" style="display: none;"><%=t_history[i].transaction_id %></td>
                                            <td class="historycompanyname"style="display: none;"><%=t_history[i].company_name %></td>
                                            <td class="historyseat" style="display: none;"><%=t_history[i].seat %></td>
                                            <td class="historylocation" style="display: none;"><%=t_history[i].location %></td>
                                            <td class="historybusno" style="display: none;"><%=t_history[i].bus_no %></td>
                                        </tr>
                                    <% } %>
                                </tbody>
                                <tfoot>
                                    <tr>
                                        <th>Ticket ID</th>
                                        <th>Date</th>
                                        <th>From</th>
                                        <th>To</th>
                                        <th>Price(GHC)</th>
                                        <th>Status</th>
                                    </tr>
                                </tfoot>
                            </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <% include layouts/footer.ejs %>
    </div>
    
</body>

</html>